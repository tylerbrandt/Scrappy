{% extends "scrapbook/base.html" %}

{% block title %}{{ book }}{% endblock %}

{% block content %}
<div class="sidebar">
	<nav class="entry_date">
		<a class="all" href="#">All</a>
		{% load custom_tags %}
		{{ book.get_entries_by_date|nav_ul }}
	</nav>
</div>
<div class="main_content">
<header class="header">
<h1>{{ book }}</h1>
<p class="subheader">{{ book.entry_set.all.count }} entries</p>
{% if actions %}
<a class="action" href="./edit">Edit</a>
{% endif %}
</header>
{% if book.image %}
<img src="{{ book.image.url }}" />
{% endif %}

{% if book.geo %}
<section class="map">
	<div class="map_wrapper photo_corners">
		<div id="map_canvas" class="map_canvas">
			<noscript>Please enable Javascript to see your checkins on a map</noscript>
		</div>
	</div>
</section>
{% endif %}

<header class="book_header">
	<h2>Entries</h2>
	{% if actions %}
	<a class="action" href="./entries/new/">New</a>
	{% endif %}
	
</header>

<section class="book_entries">
{% load thumbnail %}

{% for entry in entries %}
<article id="entry_{{ forloop.counter }}" class="book_entry" data-date="{{ entry.date }}">
	<header>
		<h3><a href="{% url entry_detail pk=entry.object.id %}">{{ entry.object }}</a></h3>
		{% if entry.object.checkin %}
		<p class="checkin" data-geo="{{ entry.location }}">
			<span class='title'>{{ entry.object.checkin }}</span>
		</p>
		{% endif %}
	</header>
	<section class="body clearfix">
		{% thumbnail entry.thumbnail.image entry.thumbnail.size as thumb %}
		<div class="thumbnail">
			<img src="{{thumb.url}}" />
		</div>
		{% endthumbnail %}
		<div class="description">
			{{ entry.description|linebreaks }}
			<a href="{% url entry_detail pk=entry.object.id %}">Read More...</a>
		</div>
	</section>
</article>
{% endfor %}
</section>
</div>
{% endblock content %}

{% block scripts %}
<script type="text/javascript" src="/media/js/nav.js"></script>

{% if book.geo %}
<!-- Google maps API -->
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
<script src="/media/js/map.js"></script>
{% endif %}

<script src="/media/js/entry_date.js"></script>
{% endblock %}