{% extends "scrapbook/base.html" %}

{% block title %}{{ book }}{% endblock %}

{% block scripts %}
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
{% endblock %}

{% block content %}
<header>
<h1>{{ book }}</h1>
<p class="subheader">{{ book.entry_set.all.count }} entries</p>
{% if user.is_authenticated %}
<a class="action" href="./edit">Edit</a>
{% endif %}
</header>
<img src="{{ book.image.url }}" />

{% if book.geo %}
<section class="map">
	<div class="map_wrapper photo_corners">
		<div id="map_canvas" class="map_canvas"></div>
	</div>
</section>
{% endif %}

<section class="book_entries">
{% load thumbnail %}
<header>
<h2>Entries</h2>
{% if user.is_authenticated %}
<a class="action" href="./entries/new/">New</a>
{% endif %}
</header>
{% for entry in entries %}
<article id="entry_{{ entry.object.orderNum }}">
	<header>
		<h3><a href="{% url entry_detail pk=entry.object.id %}">{{ entry.object }}</a></h3>
		{% if entry.object.checkin %}
		<p class="checkin" data-geo="{{ entry.location }}">
			<span class='title'>{{ entry.object.checkin }}</span>
		</p>
		{% endif %}
	</header>
	<section class="body clearfix">
		{% thumbnail entry.thumbnail.image entry.thumbnail.size as thumb %}
		<div class="thumbnail">
			<img src="{{thumb.url}}" />
		</div>
		{% endthumbnail %}
		<div class="description">
			{{ entry.description|linebreaks }}
			<a href="{% url entry_detail pk=entry.object.id %}">Read More...</a>
		</div>
	</section>
</article>
{% endfor %}
</section>
<script src="/media/js/map.js"></script>
{% endblock content %}